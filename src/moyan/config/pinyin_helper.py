# src/moyan/config/pinyin_helper.py
"""
拼音首字母生成工具
专门用于A股股票名称的拼音转换
"""

# 更完整的汉字拼音首字母映射表
PINYIN_MAP = {
    # 常用字
    'A': '阿啊', 'B': '八白百班板办半帮包保北比毕变标表别兵博不部',
    'C': '财采参草层产常长车成承城池持出初创川传春次从',
    'D': '大代带单道得的地第点电东动都度端对多', 
    'E': '二儿',
    'F': '发法方非费分风丰福服富复', 'G': '干感港高格个工公共股关广国过',
    'H': '海含汉好和河黑恒红后华环黄海汇会火货', 'I': '',
    'J': '机基积极及技际家建江交金今进京九具军',
    'K': '开科可口快', 'L': '来兰老乐力利联量林流龙路绿',
    'M': '马买满美米民明', 'N': '南能年农', 'O': '',
    'P': '派盘平普', 'Q': '七奇期汽前强青清区全',
    'R': '人日如', 'S': '三山商上设深生时实世首水思四苏',
    'T': '太特天通投土', 'U': '', 'V': '',
    'W': '万网为维文我五物', 'X': '西希小新信兴星行雄需学',
    'Y': '一医宜银用有友元园远月运', 'Z': '在造增长者中重主准资总'
}

# 创建反向映射：汉字 -> 拼音首字母
CHAR_TO_PINYIN = {}
for pinyin, chars in PINYIN_MAP.items():
    for char in chars:
        CHAR_TO_PINYIN[char] = pinyin.lower()

# 补充更多股票相关汉字
STOCK_CHARS = {
    '中': 'z', '际': 'j', '旭': 'x', '创': 'c', '宁': 'n', '德': 'd', '时': 's', '代': 'd',
    '比': 'b', '亚': 'y', '迪': 'd', '贵': 'g', '州': 'z', '茅': 'm', '台': 't',
    '平': 'p', '安': 'a', '银': 'y', '行': 'h', '招': 'z', '商': 's',
    '东': 'd', '方': 'f', '锆': 'g', '业': 'y', '财': 'c', '富': 'f',
    '海': 'h', '康': 'k', '威': 'w', '视': 's', '科': 'k', '技': 'j',
    '五': 'w', '粮': 'l', '液': 'y', '万': 'w', '腾': 't', '讯': 'x',
    '控': 'k', '股': 'g', '份': 'f', '有': 'y', '限': 'x', '公': 'g', '司': 's',
    '集': 'j', '团': 't', '电': 'd', '力': 'l', '能': 'n', '源': 'y',
    '环': 'h', '保': 'b', '建': 'j', '设': 's', '投': 't', '资': 'z',
    '发': 'f', '展': 'z', '实': 's', '工': 'g', '医': 'y', '药': 'y',
    '食': 's', '品': 'p', '饮': 'y', '料': 'l', '汽': 'q', '车': 'c',
    '房': 'f', '地': 'd', '产': 'c', '钢': 'g', '铁': 't', '化': 'h',
    '石': 's', '油': 'y', '天': 't', '然': 'r', '气': 'q', '金': 'j',
    '融': 'r', '保': 'b', '险': 'x', '证': 'z', '券': 'q', '信': 'x',
    '托': 't', '基': 'j', '金': 'j', '管': 'g', '理': 'l', '咨': 'z',
    '询': 'x', '服': 'f', '务': 'w', '贸': 'm', '易': 'y', '进': 'j',
    '出': 'c', '口': 'k', '运': 'y', '输': 's', '物': 'w', '流': 'l',
    '仓': 'c', '储': 'c', '供': 'g', '应': 'y', '链': 'l', '采': 'c',
    '购': 'g', '销': 'x', '售': 's', '零': 'l', '售': 's', '批': 'p',
    '制': 'z', '造': 'z', '生': 's', '产': 'c', '加': 'j', '工': 'g',
    '装': 'z', '备': 'b', '机': 'j', '械': 'x', '设': 's', '备': 'b',
    '器': 'q', '材': 'c', '料': 'l', '元': 'y', '件': 'j', '零': 'l',
    '部': 'b', '件': 'j', '配': 'p', '套': 't', '模': 'm', '具': 'j',
    '工': 'g', '具': 'j', '刀': 'd', '具': 'j', '量': 'l', '具': 'j',
    '检': 'j', '测': 'c', '计': 'j', '量': 'l', '标': 'b', '准': 'z',
    '质': 'z', '量': 'l', '认': 'r', '证': 'z', '体': 't', '系': 'x',
    '农': 'n', '林': 'l', '牧': 'm', '渔': 'y', '种': 'z', '植': 'z',
    '养': 'y', '殖': 'z', '饲': 's', '料': 'l', '兽': 's', '药': 'y',
    '疫': 'y', '苗': 'm', '肥': 'f', '料': 'l', '农': 'n', '机': 'j',
    '水': 's', '利': 'l', '灌': 'g', '溉': 'g', '排': 'p', '水': 's',
    '治': 'z', '污': 'w', '环': 'h', '境': 'j', '监': 'j', '测': 'c',
    '新': 'x', '材': 'c', '料': 'l', '纳': 'n', '米': 'm', '碳': 't',
    '纤': 'x', '维': 'w', '复': 'f', '合': 'h', '材': 'c', '料': 'l',
    '稀': 'x', '土': 't', '永': 'y', '磁': 'c', '超': 'c', '导': 'd',
    '半': 'b', '导': 'd', '体': 't', '芯': 'x', '片': 'p', '集': 'j',
    '成': 'c', '电': 'd', '路': 'l', '传': 'c', '感': 'g', '器': 'q',
    '显': 'x', '示': 's', '器': 'q', '液': 'y', '晶': 'j', '面': 'm',
    '板': 'b', '触': 'c', '摸': 'm', '屏': 'p', '智': 'z', '能': 'n',
    '手': 's', '机': 'j', '计': 'j', '算': 's', '机': 'j', '服': 'f',
    '务': 'w', '器': 'q', '存': 'c', '储': 'c', '器': 'q', '硬': 'y',
    '盘': 'p', '内': 'n', '存': 'c', 'U': 'u', 'S': 's', 'B': 'b',
    '光': 'g', '纤': 'x', '通': 't', '信': 'x', '网': 'w', '络': 'l',
    '互': 'h', '联': 'l', '网': 'w', '物': 'w', '联': 'l', '网': 'w',
    '云': 'y', '计': 'j', '算': 's', '大': 'd', '数': 's', '据': 'j',
    '人': 'r', '工': 'g', '智': 'z', '能': 'n', '机': 'j', '器': 'q',
    '学': 'x', '习': 'x', '深': 's', '度': 'd', '学': 'x', '习': 'x',
    '神': 's', '经': 'j', '网': 'w', '络': 'l', '算': 's', '法': 'f',
    '模': 'm', '型': 'x', '训': 'x', '练': 'l', '推': 't', '理': 'l',
    '预': 'y', '测': 'c', '识': 's', '别': 'b', '分': 'f', '类': 'l',
    '聚': 'j', '类': 'l', '回': 'h', '归': 'g', '优': 'y', '化': 'h'
}

# 合并字典
CHAR_TO_PINYIN.update(STOCK_CHARS)

def get_pinyin_initial(text: str) -> str:
    """
    获取中文文本的拼音首字母
    
    Args:
        text: 中文文本
        
    Returns:
        str: 拼音首字母字符串
    """
    if not text:
        return ''
    
    result = ''
    for char in text:
        if char in CHAR_TO_PINYIN:
            result += CHAR_TO_PINYIN[char]
        elif '\u4e00' <= char <= '\u9fff':  # 中文字符
            # 对于未映射的中文字符，使用简单规则
            # 按照常见读音规律进行估算
            unicode_val = ord(char)
            if unicode_val < 20000:
                result += chr(ord('a') + (unicode_val % 26))
            else:
                result += 'z'
        elif char.isalpha():
            result += char.lower()
        # 数字和其他字符忽略
    
    return result

# 测试函数
if __name__ == '__main__':
    test_names = [
        '中际旭创', '宁德时代', '比亚迪', '贵州茅台', 
        '平安银行', '招商银行', '东方财富', '海康威视',
        '科大讯飞', '五粮液', '万科A', '腾讯控股',
        '中国平安', '工商银行', '建设银行', '农业银行'
    ]
    
    print("股票名称拼音首字母测试:")
    for name in test_names:
        pinyin = get_pinyin_initial(name)
        print(f'{name:8s} -> {pinyin}')
